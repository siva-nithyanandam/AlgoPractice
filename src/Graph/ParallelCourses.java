package Graph;

/**
 * Author - Sivaprakash Nithyanandam
 *
 * @see <a href="https://github.com/trysivaprakash">trysivaprakash</a>
 * Dec 30,2022 - 12:31 PM
 */

import java.util.*;
import java.util.stream.IntStream;

/**
 * https://leetcode.com/explore/learn/card/graph/623/kahns-algorithm-for-topological-sorting/3954/
 *
 * You are given an integer n, which indicates that there are n courses labeled from 1 to n. You are also given an array relations where relations[i] = [prevCoursei, nextCoursei], representing a prerequisite relationship between course prevCoursei and course nextCoursei: course prevCoursei has to be taken before course nextCoursei.
 *
 * In one semester, you can take any number of courses as long as you have taken all the prerequisites in the previous semester for the courses you are taking.
 *
 * Return the minimum number of semesters needed to take all courses. If there is no way to take all the courses, return -1.
 *
 *
 *
 * Example 1:
 *
 *
 * Input: n = 3, relations = [[1,3],[2,3]]
 * Output: 2
 * Explanation: The figure above represents the given graph.
 * In the first semester, you can take courses 1 and 2.
 * In the second semester, you can take course 3.
 * Example 2:
 *
 *
 * Input: n = 3, relations = [[1,2],[2,3],[3,1]]
 * Output: -1
 * Explanation: No course can be studied because they are prerequisites of each other.
 *
 *
 * Constraints:
 *
 * 1 <= n <= 5000
 * 1 <= relations.length <= 5000
 * relations[i].length == 2
 * 1 <= prevCoursei, nextCoursei <= n
 * prevCoursei != nextCoursei
 * All the pairs [prevCoursei, nextCoursei] are unique.
 */

public class ParallelCourses {
    public static void main(String[] args) {
        ParallelCourses o = new ParallelCourses();
        System.out.println(o.minimumSemesters(999, new int[][]{{252,667},{92,775},{465,727},{584,794},{103,54},{889,766},{768,981},{947,491},{387,63},{971,651},{279,775},{829,215},{980,687},{872,696},{335,731},{236,804},{153,8},{576,319},{754,746},{237,511},{185,491},{994,442},{442,833},{91,745},{918,660},{66,104},{808,141},{180,505},{199,926},{194,226},{124,339},{532,338},{696,951},{659,232},{967,235},{799,681},{409,930},{93,977},{689,68},{925,429},{501,546},{971,709},{596,697},{27,47},{131,537},{492,499},{389,993},{480,274},{9,734},{778,928},{836,807},{872,953},{205,537},{203,390},{376,622},{736,821},{707,91},{193,522},{601,845},{4,619},{223,23},{62,757},{784,358},{452,87},{507,206},{644,826},{649,883},{314,403},{367,432},{567,597},{424,451},{945,621},{253,674},{198,562},{254,998},{406,87},{594,129},{462,272},{855,12},{603,359},{421,404},{588,632},{192,556},{609,47},{479,876},{127,256},{68,496},{471,385},{955,30},{454,792},{429,873},{344,490},{749,975},{560,8},{126,342},{86,355},{47,884},{25,580},{798,763},{516,569},{602,523},{280,409},{365,674},{725,797},{571,815},{137,476},{719,538},{198,577},{779,518},{948,564},{556,18},{681,90},{243,925},{825,323},{235,212},{838,462},{152,452},{65,813},{891,254},{337,830},{373,132},{759,161},{539,770},{171,348},{596,548},{466,92},{502,586},{53,973},{375,988},{907,689},{409,243},{790,652},{228,555},{505,499},{49,895},{397,466},{584,667},{471,853},{842,35},{83,165},{305,444},{192,404},{837,474},{864,573},{482,430},{589,169},{207,471},{844,241},{921,73},{274,519},{220,246},{881,81},{208,344},{235,191},{407,39},{682,145},{264,516},{680,7},{803,337},{733,749},{882,875},{219,229},{672,408},{571,183},{923,913},{891,652},{69,76},{953,832},{870,486},{422,959},{806,216},{146,706},{154,907},{383,454},{101,770},{160,12},{249,321},{308,224},{376,120},{850,534},{571,159},{846,291},{632,551},{68,107},{89,644},{402,889},{340,16},{512,241},{348,513},{439,937},{273,316},{524,890},{400,883},{523,872},{235,208},{507,41},{953,612},{480,152},{853,467},{469,957},{960,353},{64,448},{347,435},{938,226},{145,129},{822,156},{93,757},{462,270},{848,145},{843,923},{384,756},{285,990},{762,863},{75,549},{317,281},{244,416},{88,913},{94,935},{290,409},{848,485},{781,36},{905,616},{236,750},{8,65},{47,833},{883,781},{867,857},{29,379},{642,412},{74,417},{86,670},{834,386},{593,654},{159,861},{384,724},{182,241},{716,671},{410,136},{69,788},{762,544},{147,638},{287,486},{677,157},{907,966},{87,649},{431,5},{119,681},{61,941},{792,746},{863,25},{95,143},{909,656},{221,631},{893,661},{518,350},{61,259},{293,315},{908,914},{340,900},{612,762},{190,258},{928,4},{53,441},{430,691},{258,961},{474,816},{868,557},{615,133},{642,553},{582,518},{210,361},{788,905},{486,85},{125,556},{536,697},{178,117},{145,701},{431,711},{143,293},{307,817},{770,271},{126,367},{298,497},{882,768},{560,546},{460,693},{960,410},{613,250},{58,223},{17,761},{833,275},{283,336},{249,864},{474,192},{155,979},{50,807},{37,759},{785,874},{227,989},{388,915},{518,751},{505,396},{61,804},{663,177},{471,793},{98,6},{577,643},{319,973},{323,546},{218,84},{214,401},{239,637},{339,381},{87,112},{971,149},{916,146},{763,790},{514,837},{76,343},{301,940},{500,479},{45,908},{613,600},{99,974},{270,574},{659,872},{277,932},{355,636},{821,754},{784,278},{593,93},{365,497},{347,529},{663,415},{592,166},{258,620},{107,932},{275,661},{907,185},{946,638},{811,893},{447,47},{941,874},{600,934},{434,647},{900,633},{376,82},{222,202},{588,144},{824,167},{316,252},{894,353},{561,956},{546,560},{522,992},{623,368},{942,181},{53,200},{246,218},{811,964},{273,311},{614,532},{390,159},{540,997},{691,568},{304,819},{257,147},{25,574},{416,854},{470,576},{763,448},{595,827},{813,701},{527,639},{72,993},{522,100},{420,583},{948,101},{904,286},{920,950},{689,65},{325,103},{848,472},{209,988},{554,811},{11,328},{869,328},{32,652},{618,747},{83,91},{949,858},{47,487},{11,145},{444,226},{161,58},{442,846},{459,455},{202,667},{344,699},{342,805},{53,910},{352,392},{133,172},{227,259},{758,227},{267,473},{538,810},{42,646},{115,459},{170,968},{587,487},{430,925},{735,930},{294,8},{827,95},{644,108},{343,56},{334,236},{550,434},{439,756},{824,265},{574,893},{289,243},{964,142},{350,660},{844,290},{512,802},{32,585},{130,932},{840,53},{343,701},{266,275},{925,244},{965,641},{563,452},{157,219},{276,935},{364,229},{783,111},{992,434},{175,952},{608,963},{447,743},{12,341},{332,467},{960,408},{124,327},{1,969},{45,188},{442,968},{930,193},{590,311},{391,141},{311,664},{509,335},{692,293},{507,934},{651,82},{38,923},{796,482},{484,971},{506,338},{526,519},{391,592},{997,795},{190,89},{577,726},{312,822},{566,626},{344,883},{186,229},{564,865},{421,817},{513,265},{32,148},{366,883},{888,331},{919,603},{657,331},{979,663},{186,346},{793,210},{591,29},{706,480},{217,410},{780,937},{770,508},{489,691},{138,283},{440,313},{153,48},{912,411},{925,558},{468,448},{375,652},{191,800},{751,631},{733,86},{389,415},{659,492},{482,991},{891,549},{263,713},{898,133},{752,32},{577,483},{245,180},{853,846},{554,544},{126,244},{329,23},{933,49},{854,170},{297,718},{52,689},{614,97},{636,453},{892,90},{121,31},{771,370},{859,499},{594,782},{581,339},{379,896},{247,594},{452,399},{933,563},{981,80},{701,222},{872,713},{731,674},{424,845},{433,369},{986,553},{858,276},{929,418},{576,853},{518,976},{394,137},{679,427},{142,261},{10,242},{621,963},{974,749},{923,717},{899,299},{187,867},{483,19},{198,324},{166,254},{569,610},{50,761},{268,916},{568,738},{319,415},{192,854},{95,214},{36,851},{196,321},{864,831},{26,258},{426,382},{772,147},{587,934},{203,591},{743,10},{962,263},{24,201},{520,331},{474,825},{742,569},{496,214},{89,937},{775,413},{579,899},{549,130},{505,120},{127,806},{255,840},{607,667},{490,218},{353,307},{497,922},{597,769},{354,615},{661,889},{778,121},{420,320},{542,113},{483,50},{409,561},{651,257},{104,825},{85,731},{741,487},{139,113},{478,431},{353,7},{839,364},{419,209},{880,838},{331,574},{575,690},{507,628},{694,988},{54,306},{830,111},{682,964},{906,541},{47,882},{130,810},{897,978},{24,406},{474,342},{644,704},{716,622},{621,37},{645,910},{611,238},{949,574},{639,967},{888,134},{710,942},{692,295},{269,340},{173,901},{572,513},{690,693},{292,722},{44,662},{60,890},{179,403},{642,773},{350,998},{880,563},{724,344},{671,624},{513,56},{990,752},{173,669},{583,940},{195,216},{720,481},{237,209},{66,88},{389,689},{602,437},{296,850},{887,790},{8,105},{216,823},{585,116},{306,320},{887,960},{551,85},{622,58},{825,612},{180,593},{504,447},{53,725},{118,430},{622,395},{816,401},{278,974},{472,754},{259,520},{873,349},{418,815},{902,199},{463,122},{682,36},{842,222},{422,203},{437,463},{150,687},{502,106},{473,952},{296,355},{828,221},{877,992},{446,554},{235,799},{629,421},{329,688},{552,288},{276,833},{670,829},{326,242},{8,358},{716,426},{253,521},{33,673},{56,165},{892,626},{834,103},{109,929},{110,788},{398,230},{235,708},{893,534},{718,108},{834,102},{885,237},{573,105},{877,194},{968,548},{839,324},{663,664},{600,743},{322,670},{454,373},{733,121},{461,806},{736,513},{994,51},{938,783},{451,756},{922,826},{418,289},{89,150},{111,419},{450,876},{977,772},{80,241},{222,268},{705,216},{814,443},{780,679},{984,746},{319,75},{854,117},{856,857},{467,323},{22,387},{333,200},{327,523},{567,478},{521,111},{501,35},{545,341},{819,545},{76,497},{815,833},{339,820},{955,696},{873,934},{72,342},{693,699},{928,993},{862,592},{755,482},{288,403},{578,219},{606,241},{123,126},{630,940},{329,188},{536,341},{660,278},{61,548},{287,642},{65,448},{998,251},{421,531},{484,222},{936,494},{863,366},{285,408},{927,769},{57,876},{71,40},{944,519},{72,909},{995,921},{241,275},{583,277},{695,917},{894,783},{878,70},{252,162},{143,207},{508,14},{26,800},{537,820},{894,677},{16,936},{936,722},{414,574},{108,721},{30,995},{943,815},{882,402},{121,967},{551,287},{871,454},{771,721},{382,822},{136,146},{322,848},{908,13},{423,432},{742,313},{456,960},{502,417},{151,148},{614,714},{700,985},{489,407},{172,995},{170,785},{798,103},{565,440},{940,570},{515,210},{540,9},{420,565},{921,779},{513,629},{196,705},{955,491},{311,545},{747,454},{882,782},{863,194},{275,52},{270,584},{413,63},{804,149},{38,775},{926,94},{467,86},{150,38},{795,539},{680,987},{14,426},{635,891},{548,164},{181,545},{711,898},{276,249},{285,739},{121,3},{184,928},{452,795},{124,688},{354,19},{931,307},{696,307},{5,65},{864,525},{751,892},{33,945},{146,125},{928,810},{668,93},{843,856},{166,710},{819,586},{253,466},{163,596},{724,334},{883,435},{49,119},{49,921},{573,632},{131,894},{616,396},{459,289},{236,187},{416,405},{15,380},{179,249},{766,17},{601,13},{595,282},{919,575},{820,554},{424,662},{866,341},{535,978},{729,944},{365,471},{290,960},{196,941},{482,834},{359,396},{727,185},{493,811},{793,505},{672,530},{418,58},{245,553},{896,856},{412,80},{398,794},{378,78},{946,131},{586,446},{395,822},{673,556},{81,216},{457,693},{624,669},{301,447},{476,699},{688,343},{598,244},{923,619},{193,640},{873,170},{932,197},{478,773},{262,793},{771,45},{733,102},{112,945},{565,317},{298,154},{322,415},{351,213},{872,980},{932,930},{606,123},{452,463},{80,326},{440,316},{487,45},{942,356},{310,178},{184,677},{300,254},{869,561},{678,929},{370,414},{17,244},{976,726},{350,733},{965,757},{220,43},{870,136},{461,11},{870,762},{992,432},{324,524},{315,940},{375,408},{14,930},{650,955},{62,17},{705,179},{17,862},{911,31},{513,442},{444,676},{82,305},{73,463},{632,693},{947,440},{493,729},{956,977},{384,348},{32,916},{603,83},{925,758},{975,471},{118,11},{836,245},{946,64},{441,694},{412,104},{472,233},{144,527},{18,599},{160,153},{423,355},{814,893},{278,176},{810,911},{213,938},{505,614},{304,285},{830,718},{451,339},{201,584},{154,411},{344,635},{126,7},{265,636},{840,112},{221,107},{577,149},{717,576},{715,674},{77,249},{700,712},{350,830},{32,605},{342,187},{67,355},{773,775},{315,582},{55,495},{493,389},{712,994},{129,804},{912,84},{880,163},{931,921},{583,679},{593,414},{682,807},{238,685},{325,2},{218,564},{101,146},{678,557},{261,238},{104,120},{360,712},{178,738},{490,495},{747,359},{981,47},{795,298},{43,683},{413,323},{737,359},{811,791},{697,883},{789,345},{908,266},{562,591},{463,838},{397,840},{873,954},{707,634},{755,589},{590,215},{940,943},{643,878},{934,510},{714,734},{903,273},{504,170},{363,904},{754,205},{415,283},{71,291},{88,832},{305,811},{422,592},{253,59},{160,582},{310,106},{948,257},{92,174},{644,994},{320,53},{245,65},{544,592},{218,963},{359,987},{418,719},{588,241},{486,410},{8,131},{752,738},{921,559},{66,931},{399,91},{557,592},{129,321},{907,94},{673,150},{498,685},{175,921},{896,58},{24,901},{633,909},{515,268},{506,916},{293,298},{189,885},{389,432},{66,655},{470,794},{235,367},{698,333},{727,189},{578,967},{209,144},{376,207},{751,120},{563,97},{331,444},{63,488},{52,223},{272,976},{274,719},{812,21},{461,149},{845,288},{978,794},{300,85},{47,506},{155,321},{5,760},{187,496},{888,111},{965,785},{600,414},{739,344},{566,393},{992,589},{775,126},{283,794},{91,811},{352,521},{88,802},{794,689},{820,233},{447,216},{590,45},{129,657},{603,55},{695,892},{307,207},{67,325},{478,610},{909,63},{949,188},{312,256},{315,696},{164,131},{32,423},{546,479},{950,433},{774,146},{44,844},{605,65},{787,549},{640,672},{644,689},{977,970},{342,689},{994,517},{807,667},{193,430},{863,831},{882,106},{183,802},{864,842},{577,410},{836,195},{262,70},{983,186},{786,48},{554,147},{781,911},{953,358},{265,715},{404,677},{597,485},{9,548},{12,224},{87,116},{253,694},{416,163},{816,674},{768,504},{577,876},{226,748},{730,559},{217,238},{483,8},{274,403},{728,633},{286,484},{764,106},{3,543},{700,496},{56,916},{999,192},{485,398},{27,450},{364,772},{946,57},{559,609},{712,328},{227,574},{505,911},{535,570},{61,429},{716,322},{312,786},{3,961},{719,499},{170,959},{430,72},{602,942},{727,843},{632,127},{793,693},{877,33},{34,935},{88,383},{387,173},{773,83},{828,328},{908,55},{75,926},{337,900},{920,18},{61,311},{891,679},{815,838},{993,896},{876,690},{539,910},{19,441},{123,318},{577,936},{189,978},{297,150},{522,756},{947,848},{560,264},{59,414},{295,114},{972,494},{796,65},{937,990},{22,394},{668,550},{290,591},{752,580},{289,44},{133,124},{727,748},{734,147},{734,657},{293,306},{594,273},{915,753},{38,713},{366,630},{180,252},{898,39},{705,942},{677,518},{883,83},{14,471},{690,934},{106,854},{721,472},{946,317},{80,763},{283,958},{473,448},{839,210},{399,49},{308,109},{662,705},{940,197},{423,704},{997,640},{431,829},{520,962},{934,361},{485,147},{766,815},{212,831},{868,526},{821,270},{360,839},{69,729},{131,392},{392,542},{872,976},{694,4},{123,166},{921,791},{870,613},{739,252},{571,648},{108,540},{624,430},{620,46},{826,970},{614,186},{333,436},{949,434},{171,91},{378,21},{501,247},{946,822},{425,102},{322,89},{57,116},{746,448},{234,423},{925,804},{566,774},{863,923},{614,26},{895,703},{196,517},{39,840},{505,883},{931,175},{823,764},{721,181},{287,105},{440,201},{974,195},{76,433},{616,82},{570,429},{25,612},{632,379},{459,959},{32,546},{150,511},{182,747},{14,947},{474,285},{992,309},{296,579},{233,965},{778,980},{665,22},{861,153},{252,145},{232,601},{826,97},{306,883},{293,754},{92,379},{974,984},{397,237},{789,440},{362,162},{669,550},{927,299},{571,606},{401,707},{672,658},{670,561},{12,592},{455,145},{26,542},{372,909},{523,239},{959,224},{842,911},{807,54},{343,737},{295,242},{554,369},{607,345},{604,46},{993,378},{56,741},{401,628},{336,52},{458,825},{218,661},{257,638},{908,168},{440,830},{104,316},{869,600},{354,75},{935,216},{167,79},{755,805},{273,563},{486,789},{38,416},{463,281},{197,878},{716,867},{262,297},{27,884},{317,860},{262,545},{137,68},{421,191},{559,254},{988,335},{807,241},{251,499},{939,74},{988,659},{252,519},{367,38},{195,50},{165,188},{430,163},{310,446},{86,442},{608,938},{780,899},{135,411},{897,187},{131,812},{680,282},{196,187},{282,937},{834,504},{538,558},{839,523},{283,682},{191,197},{188,967},{384,395},{602,265},{212,986},{644,251},{258,802},{604,346},{44,543},{855,816},{936,940},{894,712},{195,8},{983,990},{483,177},{769,861},{677,435},{336,709},{175,421},{705,912},{738,679},{10,670},{50,613},{837,992},{711,835},{882,414},{82,98},{768,805},{331,850},{577,737},{249,173},{929,706},{683,694},{217,639},{477,77},{402,864},{455,197},{401,906},{492,703},{358,501},{604,558},{901,983},{474,79},{302,263},{707,159},{592,591},{306,43},{380,317},{337,455},{240,856},{545,529},{606,15},{343,543},{237,826},{992,877},{287,393},{838,229},{561,974},{772,89},{131,759},{259,249},{203,479},{828,908},{915,486},{717,990},{159,385},{82,370},{750,904},{987,530},{518,191},{672,918},{352,707},{933,581},{974,469},{509,166},{257,331},{711,524},{605,980},{140,327},{520,568},{79,408},{827,476},{497,191},{593,277},{818,617},{220,177},{305,283},{788,773},{547,637},{489,554},{460,421},{893,603},{433,359},{610,965},{148,747},{304,104},{745,691},{172,536},{780,681},{523,988},{212,62},{628,737},{709,240},{396,928},{668,24},{417,538},{663,410},{878,102},{515,264},{571,83},{770,994},{174,294},{637,185},{929,442},{964,854},{283,281},{78,287},{506,660},{585,980},{277,24},{503,523},{176,587},{524,98},{129,857},{443,249},{361,720},{916,847},{705,866},{420,172},{118,186},{555,365},{983,820},{824,470},{129,601},{464,721},{864,689},{977,911},{127,712},{621,846},{305,212},{317,78},{897,95},{533,94},{600,815},{168,289},{887,962},{635,438},{525,244},{953,50},{381,980},{743,795},{274,266},{348,912},{944,177},{841,402},{336,664},{125,150},{617,753},{692,290},{723,208},{302,133},{430,998},{693,644},{156,517},{588,423},{546,695},{752,449},{388,131},{552,791},{963,96},{735,193},{732,265},{492,668},{320,49},{108,627},{892,995},{446,659},{701,320},{169,884},{933,932},{134,421},{176,226},{705,7},{385,909},{688,112},{844,178},{223,97},{426,950},{991,391},{780,550},{818,29},{572,532},{220,913},{549,307},{638,922},{63,734},{785,626},{636,657},{253,242},{196,774},{690,805},{886,61},{724,239},{25,382},{168,233},{650,464},{902,293},{600,718},{245,73},{946,429},{405,874},{499,28},{132,276},{555,391},{639,797},{749,781},{857,970},{227,462},{315,421},{726,103},{777,639},{196,319},{816,141},{922,233},{975,761},{625,430},{440,848},{360,78},{474,469},{473,7},{331,413},{744,211},{223,396},{251,579},{663,9},{173,110},{560,953},{741,190},{817,800},{424,205},{162,241},{950,579},{734,574},{114,148},{583,893},{132,968},{836,106},{668,985},{627,295},{408,307},{298,356},{509,540},{411,101},{778,640},{701,121},{77,664},{737,103},{904,71},{446,642},{14,478},{217,37},{788,298},{205,34},{442,649},{300,156},{170,169},{765,864},{862,823},{864,100},{779,80},{388,85},{417,158},{887,664},{176,772},{2,865},{401,508},{9,279},{151,105},{784,718},{188,701},{195,611},{343,768},{473,261},{665,931},{624,224},{39,81},{939,121},{668,233},{684,703},{818,816},{562,274},{953,438},{609,301},{135,750},{362,577},{365,947},{987,280},{454,139},{889,584},{854,63},{664,853},{459,821},{705,300},{564,323},{559,212},{300,643},{733,509},{225,700},{112,923},{400,659},{19,567},{987,775},{339,712},{343,598},{195,272},{244,246},{808,938},{542,939},{104,948},{425,245},{457,850},{770,272},{802,304},{171,819},{946,901},{183,965},{610,817},{933,882},{777,341},{751,555},{35,190},{991,182},{988,563},{848,125},{919,395},{403,638},{156,148},{37,158},{222,683},{123,187},{648,506},{836,138},{794,288},{873,75},{322,413},{150,396},{724,6},{981,808},{747,955},{38,916},{488,645},{142,577},{891,112},{947,342},{336,312},{567,315},{257,915},{492,947},{335,115},{42,565},{948,335},{698,818},{350,185},{44,578},{598,912},{883,765},{200,489},{14,740},{2,980},{579,343},{875,826},{312,651},{760,928},{705,948},{316,579},{149,194},{192,655},{110,847},{710,506},{592,829},{814,52},{765,777},{439,692},{698,898},{596,407},{513,17},{954,496},{374,593},{610,432},{930,830},{308,471},{353,425},{494,890},{837,683},{554,29},{780,708},{45,770},{871,321},{763,278},{497,83},{859,481},{696,308},{402,750},{53,531},{711,354},{732,909},{810,19},{714,298},{498,924},{551,226},{820,893},{831,52},{8,387},{637,131},{571,876},{33,34},{114,719},{177,979},{568,137},{193,477},{277,560},{353,908},{248,110},{181,99},{592,425},{966,334},{128,750},{40,227},{568,893},{942,69},{718,496},{732,372},{59,5},{994,679},{454,630},{629,267},{862,268},{233,624},{842,236},{635,20},{464,594},{716,798},{975,865},{930,940},{514,39},{54,958},{293,919},{511,515},{908,450},{634,683},{466,195},{656,141},{639,889},{664,531},{264,200},{722,182},{201,646},{653,904},{625,776},{76,798},{926,4},{842,666},{423,887},{427,787},{221,231},{200,719},{445,385},{531,785},{677,846},{186,219},{889,882},{465,515},{741,545},{16,320},{776,773},{31,489},{229,329},{549,803},{288,771},{645,46},{199,164},{722,296},{641,769},{224,970},{713,483},{665,300},{642,439},{994,468},{914,688},{961,766},{450,137},{875,461},{18,46},{896,115},{258,435},{648,455},{487,183},{365,690},{241,772},{867,372},{786,692},{453,533},{954,905},{830,651},{547,11},{946,776},{777,726},{835,730},{726,91},{901,30},{186,118},{452,960},{602,361},{654,862},{592,456},{560,25},{417,549},{299,955},{714,672},{874,887},{418,561},{589,226},{639,722},{688,132},{471,369},{947,974},{528,475},{684,88},{228,737},{266,240},{196,421},{972,197},{720,948},{642,637},{780,298},{481,701},{49,759},{868,668},{300,127},{468,940},{192,476},{106,377},{606,671},{3,315},{128,374},{425,116},{468,489},{722,453},{21,410},{91,332},{706,168},{690,154},{772,420},{968,745},{241,341},{652,35},{130,815},{443,886},{894,681},{741,79},{837,62},{778,756},{549,576},{794,252},{211,523},{63,565},{371,520},{542,666},{993,750},{545,425},{345,357},{806,234},{175,973},{225,432},{142,63},{985,764},{465,344},{692,753},{339,584},{302,633},{535,860},{526,965},{165,891},{665,111},{70,22},{280,834},{80,551},{878,45},{53,876},{186,262},{811,201},{266,101},{455,5},{437,132},{682,103},{599,980},{352,573},{360,702},{775,886},{146,476},{7,733},{91,940},{694,19},{691,694},{90,898},{920,494},{446,548},{682,98},{906,560},{696,156},{631,974},{678,626},{53,104},{856,781},{996,175},{627,848},{46,278},{709,994},{613,163},{227,848},{347,788},{117,667},{77,957},{596,512},{754,292},{719,772},{257,533},{695,408},{607,701},{664,189},{929,650},{357,700},{423,524},{74,947},{345,612},{755,940},{314,594},{429,586},{970,200},{473,219},{904,309},{86,47},{905,438},{643,312},{845,602},{517,62},{518,38},{363,746},{488,361},{353,973},{529,361},{596,431},{184,943},{414,736},{20,117},{29,69},{910,96},{627,922},{317,706},{954,109},{947,882},{106,795},{910,63},{491,700},{103,498},{496,372},{617,694},{360,203},{765,849},{229,733},{897,506},{655,679},{565,371},{856,685},{393,791},{327,876},{742,478},{88,85},{399,671},{205,495},{687,843},{304,982},{792,615},{352,395},{784,282},{558,557},{851,664},{334,686},{50,693},{17,835},{161,81},{473,127},{522,890},{888,182},{591,579},{49,29},{658,52},{448,648},{72,856},{940,98},{794,488},{587,789},{630,805},{364,81},{331,242},{431,200},{65,998},{839,443},{155,404},{511,759},{444,355},{462,766},{245,379},{844,671},{242,292},{67,856},{615,172},{582,929},{762,866},{302,507},{705,263},{78,112},{764,913},{38,963},{879,123},{573,960},{226,911},{916,70},{523,667},{190,566},{733,785},{779,525},{339,369},{272,522},{902,157},{334,893},{330,810},{143,47},{785,862},{506,831},{73,397},{328,80},{19,790},{693,171},{22,649},{962,927},{165,999},{582,863},{253,433},{898,406},{434,510},{682,560},{649,717},{108,345},{513,759},{132,850},{159,800},{357,500},{673,69},{120,121},{498,255},{859,73},{695,458},{847,166},{541,824},{297,597},{141,31},{387,811},{338,277},{372,254},{539,590},{745,803},{87,954},{295,909},{150,620},{133,322},{542,387},{693,340},{832,522},{697,385},{806,29},{888,156},{837,75},{105,952},{661,110},{593,141},{279,422},{57,261},{786,231}}));
    }

    public int minimumSemesters(int n, int[][] relations) {

        int[] indegrees = new int[n+1];
        Map<Integer, List<Integer>> adjList = new HashMap<>();

        IntStream.range(0,n+1).forEach(k -> adjList.put(k, new ArrayList<>()));

        for (int[] relation : relations) {
            adjList.get(relation[0]).add(relation[1]);
            indegrees[relation[1]]++;
        }

        Queue<Integer> zeroInDegrees = new LinkedList<>();

        IntStream.range(1,n+1).filter(i -> indegrees[i] == 0).forEach(i -> zeroInDegrees.add(i));
        int nbrOfSems = 0;
        int studiedCount = 0;

        while (!zeroInDegrees.isEmpty()) {
            nbrOfSems++;
            int size = zeroInDegrees.size();

            for (int i = 0; i < size; i++) {
                studiedCount++;
                int node = zeroInDegrees.poll();
                for (int j : adjList.get(node)) {
                    indegrees[j]--;
                    if (indegrees[j] == 0) {
                        zeroInDegrees.add(j);
                    }
                }
            }
        }
        return studiedCount == n ? nbrOfSems : -1;
    }
}
